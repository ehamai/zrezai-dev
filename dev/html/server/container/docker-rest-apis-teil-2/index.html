<!doctype html><html><head><title>Docker – Teil 2: Eigene REST API</title><meta charset=utf-8><meta name=X-UA-Compatible content="IE=edge"><meta name=google-site-verification content><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" name=viewport><meta content="telephone=no" name=format-detection><meta name=description content><meta name=renderer content="webkit"><meta name=theme-color content="#ffffff"><link type=text/css rel=stylesheet href=/vendor/css/bootstrap.min.css><link rel=icon href=https://zrezai-dev.de/img/favicon/favicon.ico><link rel=stylesheet href=https://zrezai-dev.de/scss/journal.min.01b85e0898a781aa780fafeefde8fd126632f5d81889a52aa954a99e5939c759.css integrity="sha256-AbheCJingap4D6/u/ej9EmYy9dgYiaUqqVSpnlk5x1k=" media=screen><link rel=stylesheet href=https://zrezai-dev.de/scss/dark-mode.min.6a0abf23afa30e2c8d048f453f940b7c9a5afae3ed578c66f5169bdf63eb2487.css integrity="sha256-agq/I6+jDiyNBI9FP5QLfJpa+uPtV4xm9Rab32PrJIc=" media=screen><script src=/vendor/js/loadCSS.js></script><script>loadCSS("https://fonts.googleapis.com/css?family=Fira+Mono|Material+Icons");</script><script src=/js/toc.js></script><link rel=stylesheet type=text/css href=css/cookieconsent.min.css></head><body><div id=app><div id=sideContainer class=side-container><a class="a-block nav-head false" href=https://zrezai-dev.de/><div class=nav-title>Zadjad Rezai.</div><div class=nav-subtitle>DevOps.</div></a><div class=nav-link-list><a class="a-block nav-link-item false" href=/freelancing>Freelancing</a>
<a class="a-block nav-link-item false" href=/categories>Kategorien</a>
<a class="a-block nav-link-item false" href=/tags>Tags</a>
<a class="a-block nav-link-item false" href=/posts>Archiv</a>
<a class="a-block nav-link-item false" href=/index.xml>RSS Feed</a>
<a class="a-block nav-link-item false" href=/datenschutz>Datenschutz</a>
<a class="a-block nav-link-item false" href=/impressum>Impressum</a></div><div class=nav-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> von <a href=https://amazingrise.net>Rise</a> ❤️<br>Adaptiert von <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br><div style=font-size:20px><a style=margin:2px href=https://github.com/Xcalizorz target=_blank rel="noreferrer noopener" class="fa fa-github"></a><a style=margin:2px href=https://www.linkedin.com/in/zadjad-rezai/ target=_blank rel="noreferrer noopener" class="fa fa-linkedin"></a><a style=margin:2px href=https://www.xing.com/profile/Zadjad_Rezai/ target=_blank rel="noreferrer noopener" class="fa fa-xing"></a></div>&copy;
2022 Zadjad Rezai.
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css></div></div><div id=extraContainer class=extra-container><div class="toc animated-visibility" :class="{ invisible: scrollY <= 140 }"><div class=toc-content><center>- INHALTE -</center><ul><ul><li><a href=#tests onclick="onNavClick(`#tests-nav`)" id=tests-nav>Tests</a></li><li><a href=#rest-api onclick="onNavClick(`#rest-api-nav`)" id=rest-api-nav>REST API</a></li><li><a href=#docker onclick="onNavClick(`#docker-nav`)" id=docker-nav>Docker</a></li></ul></div></div><div class=pagination><a id=globalBackToTop class="pagination-action animated-visibility" href=#top :class="{ invisible: scrollY == 0 }"><i class="material-icons pagination-action-icon">keyboard_arrow_up</i></a>
<a type=button class=pagination-action id=darkModeToggleButton><span class="material-icons pagination-action-icon" id=darkModeToggleIcon>dark_mode</span></a></div></div><div class=single-column-drawer-container id=drawer v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }"><div class=drawer-content><div class=drawer-menu><a class="a-block drawer-menu-item false" href=/freelancing>Freelancing</a>
<a class="a-block drawer-menu-item false" href=/categories>Kategorien</a>
<a class="a-block drawer-menu-item false" href=/tags>Tags</a>
<a class="a-block drawer-menu-item false" href=/posts>Archiv</a>
<a class="a-block drawer-menu-item false" href=/index.xml>RSS Feed</a>
<a class="a-block drawer-menu-item false" href=/datenschutz>Datenschutz</a>
<a class="a-block drawer-menu-item false" href=/impressum>Impressum</a><div class=toc><div class=toc-content><center>- INHALTE -</center><ul><ul><li><a href=#tests onclick="onNavClick(`#tests-nav`)" id=tests-nav>Tests</a></li><li><a href=#rest-api onclick="onNavClick(`#rest-api-nav`)" id=rest-api-nav>REST API</a></li><li><a href=#docker onclick="onNavClick(`#docker-nav`)" id=docker-nav>Docker</a></li></ul></div></div></div></div></div><transition name=fade><div id=drawer-mask v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if=isDrawerOpen v-on:click=toggleDrawer></div></transition><nav id=navBar class="navbar sticky-top navbar-light single-column-nav-container"><div id=navBackground class=nav-background></div><div class="container container-narrow nav-content"><button id=nav_dropdown_btn class=nav-dropdown-toggle type=button v-on:click=toggleDrawer>
<i class=material-icons>menu</i></button>
<a id=navTitle class=navbar-brand href=https://zrezai-dev.de/>Zadjad Rezai.</a>
<button type=button class=nav-darkmode-toggle id=darkModeToggleButton2>
<i class=material-icons id=darkModeToggleIcon2>dark_mode</i></button></div></nav><div class=single-column-header-container id=pageHead v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }"><a href=https://zrezai-dev.de/><div class=single-column-header-title>Zadjad Rezai.</div><div class=single-column-header-subtitle>DevOps.</div></a></div><div id=content><div id=streamContainer class=stream-container><div class="post-list-container post-list-container-shadow"><div class=post><div class=post-head-wrapper style=background-image:url(https://i.giphy.com/media/RiHcR76mXBUT6/giphy.webp)><div class=post-title>Docker – Teil 2: Eigene REST API<div class=post-meta><time itemprop=datePublished>25.03.2020 20:16</time>
<i class=material-icons>folder</i>
<a href=/categories/>[Container]</a>
&nbsp;
<i class=material-icons>label</i>
<a href=/tags/docker>Docker</a>
&nbsp;
<a href=/tags/flask>Flask</a>
&nbsp;
<a href=/tags/rest-api>REST API</a>
&nbsp;
<i class=material-icons>schedule</i>
6 min
51 s.</div></div></div><div class=post-body-wrapper><div class=post-body v-pre><p>Um die Simplizität von Docker zu erläutern, möchte ich eine kleine Python-Anwendung erstellen, welche wir über Docker veröffentlichen und nutzen können. Der Code sollte ab Python 3.6 funktionieren und ist auf <a href=https://github.com/Xcalizorz/docker-example-restapi/tree/part-2 target=_blank rel="noreferrer noopener" aria-label="(öffnet in neuem Tab)">meinem Github-Repo</a> einsehbar. Für eine Einführung in</p><p><code>Flask</code>, schaut euch <a href=https://flask.palletsprojects.com/en/1.1.x/tutorial/#tutorial target=_blank rel="noreferrer noopener" aria-label="(öffnet in neuem Tab)">das offizielle Tutorial</a> an.</p><p>Im ersten Schritt soll nur eine simple <code>API</code> geschrieben werden, welche beim Aufrufen von <code>/response/&lt;string></code> den angegeben String als Antwort zurücksenden.</p><p>Bevor wir beginnen sollten folgende Pakete installiert werden: <code>pytest, flask</code></p><p>Gerne auch über <code>python -m pip install -r app/requirements.txt</code></p><h2 id=tests>Tests</h2><p>Nach <a href=https://zrezai-dev.de/methodik/warum-tdd/>TDD</a>-manier, beginnen wir erstmal mit einem Test – ich nutze gerne <code>pytest</code> für meine Tests, weil das ein enorm gutes Framework ist, um schnell, einfach und professionel Tests zu schreiben.</p><p>Zuerst erstellen wir die <code>./setup.cfg</code> für <code>pytest</code>.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-cfg data-lang=cfg><span style=color:#a2f;font-weight:700>[tool:pytest]</span>
<span style=color:#b44>log_auto_indent</span> <span style=color:#666>=</span> <span style=color:#b44>True</span>
<span style=color:#b44>testpaths</span> <span style=color:#666>=</span> <span style=color:#b44>app/tests</span>
</code></pre></div><p>Dann können wir mit dem Schreiben erster Tests (<code>./app/tests/test_responses.py</code>) beginnen:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>pytest</span>

<span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>app.app</span> <span style=color:#a2f;font-weight:700>import</span> app


<span style=color:#a2f>@pytest.fixture</span>
<span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>client</span>():
    app<span style=color:#666>.</span>config[<span style=color:#b44>&#39;TESTING&#39;</span>] <span style=color:#666>=</span> True

    <span style=color:#a2f;font-weight:700>with</span> app<span style=color:#666>.</span>test_client() <span style=color:#a2f;font-weight:700>as</span> client:
        <span style=color:#a2f;font-weight:700>yield</span> client


<span style=color:#a2f;font-weight:700>class</span> <span style=color:#00f>TestResponse</span>:
    <span style=color:#a2f>@pytest.mark.parametrize</span>(<span style=color:#b44>&#34;test_string&#34;</span>, [
        <span style=color:#b44>&#34;hi&#34;</span>, <span style=color:#b44>&#34;bye&#34;</span>, <span style=color:#b44>&#34;xxx&#34;</span>, <span style=color:#b44>&#34;123!&#34;</span>, <span style=color:#b44>&#34;-12312&#34;</span>,
    ])
    <span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>test_simple_response__simple_message</span>(self, client, test_string):
        response <span style=color:#666>=</span> client<span style=color:#666>.</span>get(f<span style=color:#b44>&#34;/respond/{test_string}&#34;</span>)

        <span style=color:#a2f;font-weight:700>assert</span> response<span style=color:#666>.</span>status_code <span style=color:#666>==</span> <span style=color:#666>200</span>
        <span style=color:#a2f;font-weight:700>assert</span> response<span style=color:#666>.</span>json <span style=color:#666>==</span> {<span style=color:#b44>&#39;response&#39;</span>: test_string}

    <span style=color:#a2f>@pytest.mark.parametrize</span>(<span style=color:#b44>&#34;test_string&#34;</span>, [
        <span style=color:#b44>&#34;../&#34;</span>, <span style=color:#b44>&#34;</span><span style=color:#b62;font-weight:700>\\</span><span style=color:#b44>//..&#34;</span>, <span style=color:#b44>&#34;cd ..//&#34;</span>,
    ])
    <span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>test_simple_response__wrong_url</span>(self, client, test_string):
        response <span style=color:#666>=</span> client<span style=color:#666>.</span>get(f<span style=color:#b44>&#34;/respond/{test_string}&#34;</span>)

        <span style=color:#a2f;font-weight:700>assert</span> response<span style=color:#666>.</span>status_code <span style=color:#666>==</span> <span style=color:#666>404</span>
</code></pre></div><p>In Zeile 6 bis 11 erstellen wir einen <code>Flask</code>-Testclient und nutzen diesen, um unsere <code>API</code> zu testen.</p><p>Über die <code>TestResponse</code> Klasse überprüfen wir zwei simple Szenarien</p><ol><li>Nutzer übergibt eine akzeptierte Nachricht ein <code>test_simple_response__simple_message</code></li><li>Nutzer gibt etwas nicht akzeptables ein <code>test_simple_response__wrong_url</code></li></ol><p>In Szenario 1 wird als Rückmeldung eine <code>JSON</code>-Antwort erwartet, welche so aussieht: <code>{'response': test_string}</code><br>Im zweiten Szenario wird ein <code>404-Fehler</code> erwartet.</p><h2 id=rest-api>REST API</h2><p>Da wir die Tests nun haben, können wir uns an die <code>REST API</code> setzen und unsere Tests mit <code>./app/app.py</code> zum laufen bringen.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>flask</span> <span style=color:#a2f;font-weight:700>import</span> Flask, jsonify

app <span style=color:#666>=</span> Flask(__name__)

<span style=color:#a2f>@app.route</span>(<span style=color:#b44>&#34;/respond/&lt;string&gt;&#34;</span>, methods<span style=color:#666>=</span>[<span style=color:#b44>&#39;GET&#39;</span>])
<span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>simple_response</span>(string: <span style=color:#a2f>str</span>):
    <span style=color:#a2f;font-weight:700>return</span> jsonify(
        response<span style=color:#666>=</span>string
    )


<span style=color:#a2f;font-weight:700>if</span> __name__ <span style=color:#666>==</span> <span style=color:#b44>&#39;__main__&#39;</span>:
    app<span style=color:#666>.</span>run(host<span style=color:#666>=</span><span style=color:#b44>&#39;0.0.0.0&#39;</span>, port<span style=color:#666>=</span><span style=color:#666>5000</span>)
</code></pre></div><p>In <code>Flask</code> kann man natürlich auch klassenbasiert arbeiten, aber so wie es jetzt ist, ist es erstmal in Ordnung.<br>Unsere <code>API</code> erlaubt eine <code>GET</code> Anfrage an <code>/respond/&lt;string></code> und kreiert eine <code>JSON</code>-Antwort mit dem Inhalt <code>{response: string}</code></p><p>Nun können wir unsere App via Python starten: <code>python app/app.py</code></p><div style=text-align:center><figure class="aligncenter size-large"><img src=/img/docker-2/local_1.webp alt><figcaption>Abbildung 1: GET Anfrage auf localhost</figcaption></figure></div><p>Die Tests können wir mit dem Befehl <code>pytest</code> ausführen.</p><pre><code class=language-terminal data-lang=terminal>(venv) C:\..\docker-example-restapi&gt; pytest
===================================== test session starts =====================================
platform win32 -- Python 3.7.4, pytest-5.4.1, py-1.8.1, pluggy-0.13.1
rootdir: C:\..\docker-example-restapi, inifile: setup.cfg, testpaths: app/tests
collected 8 items

app\tests\test_responses.py ........                                                     [100%]

===================================== 8 passed in 0.40s =======================================
</code></pre><p>Da alle Tests problemlos durchgelaufen sind, wissen wir, dass unsere <code>API</code> funktioniert wie wir wollen.</p><h2 id=docker>Docker</h2><p>Docker nutzt u. a. <code>Dockerfiles</code>, um die einzelnen Schritte der Instanziierung zu beschreiben.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-dockerfile data-lang=dockerfile><span style=color:#a2f;font-weight:700>FROM</span><span style=color:#b44> python:3.7.7-alpine</span><span>
</span><span></span><span style=color:#a2f;font-weight:700>COPY</span> app /app<span>
</span><span></span><span style=color:#a2f;font-weight:700>WORKDIR</span><span style=color:#b44> /app</span><span>
</span><span></span><span style=color:#a2f;font-weight:700>RUN</span> pip3 install --upgrade pip<span>
</span><span></span><span style=color:#a2f;font-weight:700>RUN</span> pip3 install -r requirements.txt<span>
</span><span></span><span style=color:#a2f;font-weight:700>EXPOSE</span><span style=color:#b44> 5000</span><span>
</span><span></span><span style=color:#a2f;font-weight:700>ENTRYPOINT</span> [<span style=color:#b44>&#34;python3&#34;</span>]<span>
</span><span></span><span style=color:#a2f;font-weight:700>CMD</span> [<span style=color:#b44>&#34;app.py&#34;</span>]&lt;/pre&gt;<span>
</span></code></pre></div><p>Gehen wir hier einmal Zeilenweise durch</p><ol><li><code>FROM</code> beschreibt wo wir beginnen wollen – wir wollen bei einer Dockerumgebung beginnen, die durch <a href=https://hub.docker.com/_/python>python:3.7.7-alpine</a> definiert ist<ul><li>Dadurch wird Python 3.7.7 installiert, ggf. heruntergeladen, falls nicht lokal vorhanden</li></ul></li><li><code>COPY</code> funktioniert wie der Linux-<code>cp</code>-Befehl. <code>cp source destination</code> – Damit wird der lokale Ordner <code>app</code> in den Docker-Ordner <code>app/</code> kopiert</li><li><code>WORKDIR</code> definiert den aktuellen Arbeitsordner</li><li><code>RUN</code> beschreibt was genau innerhalb der Docker-Instanz (bei mir eine Linux-Instanz) aufgerufen werden soll<ul><li>Im ersten Schritt upgrade ich pip</li><li>Im zweiten Schritt werden alle nötigen Abhängigkeiten installiert (genau wie bei einer lokalen Installation)</li></ul></li><li><code>EXPOSE</code> sagt aus unter welchen Ports unsere Docker-Instanz von außen erreichbar sein soll – hier 5000</li><li><code>ENTRYPOINT</code> erlaubt höhere Kontrolle der Eingangsargumente beim Starten des Containers – alle Argumente von <code>docker run</code> sind damit Argumente des <code>ENTRYPOINT</code>’s</li><li><code>CMD</code> irgendeine Anweisung an unseren Container<ul><li>Da unser <code>ENTRYPOINT</code> <code>python3</code> ist, wäre der gesamte Befehl <code>python3 app.py</code></li></ul></li></ol><p><mark>.dockerignore</mark></p><p>Eine <code>.dockerignore</code>-Datei funktioniert wie eine <code>.gitignore</code>-Datei – alles darin angegebene wird nicht Teil des Dockerbuilds. Mehr Details in der <a href=https://docs.docker.com/engine/reference/builder/#dockerignore-file>Docker Dokumentation</a>.</p><pre><code class=language-gitignore data-lang=gitignore>**/%appdata%
**/venv&lt;/pre&gt;
</code></pre><p><mark>docker build</mark></p><p>Jetzt können wir endlich anfangen zu bauen. Insgesamt wurden nur zwei Dateien mit zusammen 10 Zeilen Code hinzugefügt.<br>Nun geht es endlich in eine Shell-Umgebung (tty, powershell, etc.)</p><pre><code class=language-terminal data-lang=terminal>[node1] (local) root ~
$ ls
    docker-example-restapi

[node1] (local) root ~
$ cd docker-example-restapi/

[node1] (local) root ~/docker-example-restapi
$ ls
    Dockerfile  LICENSE     README.md   app         setup.cfg

[node1] (local) root ~/docker-example-restapi
$ docker image build --tag xcalizorz/docker-example-restapi:1.0 .
    Sending build context to Docker daemon  123.4kB
    Step 1/8 : FROM python:3.7.7-alpine
    3.7.7-alpine: Pulling from library/python
    aad63a933944: Pull complete
    f229563217f5: Pull complete
    71ded8122394: Pull complete
    807d0888ee2e: Pull complete
    95206a02ba21: Pull completeDigest: sha256:4a704ebee45695fa91125301e43eee08a85fc984d05cc75650cc66fad7826c56
    Status: Downloaded newer image for python:3.7.7-alpine
     ---&gt; 7fbc871584eb
    Step 2/8 : COPY app /app
     ---&gt; 7988d031143d
    Step 3/8 : WORKDIR /app
     ---&gt; Running in d71f7ff48d85
    Removing intermediate container d71f7ff48d85
     ---&gt; 3f69a63db409
    Step 4/8 : RUN pip3 install --upgrade pip
     ---&gt; Running in 305280adbbc9
    Requirement already up-to-date: pip in /usr/local/lib/python3.7/site-packages (20.0.2)
    Removing intermediate container 305280adbbc9
     ---&gt; 6c9da2129f02
    Step 5/8 : RUN pip3 install -r requirements.txt
     ---&gt; Running in fa85c4c1c56b
    Collecting flask
      Downloading Flask-1.1.1-py2.py3-none-any.whl (94 kB)
    Collecting pytest
      Downloading pytest-5.4.1-py3-none-any.whl (246 kB)
    Collecting Jinja2&gt;=2.10.1
      Downloading Jinja2-2.11.1-py2.py3-none-any.whl (126 kB)
    Collecting itsdangerous&gt;=0.24
      Downloading itsdangerous-1.1.0-py2.py3-none-any.whl (16 kB)
    Collecting Werkzeug&gt;=0.15
      Downloading Werkzeug-1.0.0-py2.py3-none-any.whl (298 kB)
    Collecting click&gt;=5.1
      Downloading click-7.1.1-py2.py3-none-any.whl (82 kB)
    Collecting importlib-metadata&gt;=0.12; python_version &amp;lt; &quot;3.8&quot;
      Downloading importlib_metadata-1.5.1-py2.py3-none-any.whl (30 kB)
    Collecting attrs&gt;=17.4.0
      Downloading attrs-19.3.0-py2.py3-none-any.whl (39 kB)
    Collecting packaging
      Downloading packaging-20.3-py2.py3-none-any.whl (37 kB)
    Collecting more-itertools&gt;=4.0.0
      Downloading more_itertools-8.2.0-py3-none-any.whl (43 kB)
    Collecting pluggy&amp;lt;1.0,&gt;=0.12
      Downloading pluggy-0.13.1-py2.py3-none-any.whl (18 kB)
    Collecting wcwidth
      Downloading wcwidth-0.1.9-py2.py3-none-any.whl (19 kB)
    Collecting py&gt;=1.5.0
      Downloading py-1.8.1-py2.py3-none-any.whl (83 kB)
    Collecting MarkupSafe&gt;=0.23
      Downloading MarkupSafe-1.1.1.tar.gz (19 kB)
    Collecting zipp&gt;=0.5
      Downloading zipp-3.1.0-py3-none-any.whl (4.9 kB)
    Collecting six
      Downloading six-1.14.0-py2.py3-none-any.whl (10 kB)
    Collecting pyparsing&gt;=2.0.2
      Downloading pyparsing-2.4.6-py2.py3-none-any.whl (67 kB)
    Building wheels for collected packages: MarkupSafe
      Building wheel for MarkupSafe (setup.py): started
      Building wheel for MarkupSafe (setup.py): finished with status 'done'
      Created wheel for MarkupSafe: filename=MarkupSafe-1.1.1-py3-none-any.whl size=12629 sha256=235a27d61d695fffaab5a991ce459a0ba4a9eae57113c9b6bf5a9a5c89e45088
      Stored in directory: /root/.cache/pip/wheels/b9/d9/ae/63bf9056b0a22b13ade9f6b9e08187c1bb71c47ef21a8c9924
    Successfully built MarkupSafe
    Installing collected packages: MarkupSafe, Jinja2, itsdangerous, Werkzeug, click, flask, zipp, importlib-metadata, attrs, six, pyparsing, packaging, more-itertools, pluggy, wcwidth, py, pytest
    Successfully installed Jinja2-2.11.1 MarkupSafe-1.1.1 Werkzeug-1.0.0 attrs-19.3.0 click-7.1.1 flask-1.1.1 importlib-metadata-1.5.1 itsdangerous-1.1.0 more-itertools-8.2.0 packaging-20.3 pluggy-0.13.1 py-1.8.1 pyparsing-2.4.6 pytest-5.4.1 six-1.14.0 wcwidth-0.1.9 zipp-3.1.0
    Removing intermediate container fa85c4c1c56b
     ---&gt; d640ba0e6471
    Step 6/8 : EXPOSE 5000
     ---&gt; Running in abf93887096d
    Removing intermediate container abf93887096d
     ---&gt; 9792a24ce22b
    Step 7/8 : ENTRYPOINT [&quot;python3&quot;]
     ---&gt; Running in 5559040fecef
    Removing intermediate container 5559040fecef
     ---&gt; fb509e1def0d
    Step 8/8 : CMD [&quot;app.py&quot;]
     ---&gt; Running in 52f84a3385e2
    Removing intermediate container 52f84a3385e2
     ---&gt; c4256a07215a
    Successfully built c4256a07215a
    Successfully tagged xcalizorz/docker-example-restapi:1.0
</code></pre><p>Wir navigieren einfach in den Arbeitsordner <code>docker-example-restapi</code> und geben folgenden Befehl ein:</p><p><code>docker image build --tag xcalizorz/docker-example-restapi:1.0 .</code></p><ul><li><code>docker image build</code> erstellt das Docker Image</li><li><code>--tag</code> erlaubt es uns einen benutzerdefinierten Namen zu vergeben</li><li><code>.</code> ist der relative Pfad zum Ordner mit dem <code>Dockerfile</code></li><li><code>xcalizorz</code> ist meine Dockerhub ID</li></ul><p>Nun haben wir ein Docker Image, jedoch läuft es noch nicht. Wenn man eine VM installiert und vorbereitet hat, ist diese z. B. in Virtualbox sichtbar – sie wurde schon <em>gebaut</em>, jedoch ist die VM noch aus.</p><p>Mit folgendem Befehl starten wir unser Image:</p><pre><code class=language-terminal data-lang=terminal>[node1] (local) root ~/docker-example-restapi
$ docker container run --detach --publish 8080:5000 --name responder xcalizorz/docker-example-restapi:1.0
    7679e475e1517d2850c14fd6ffc7cc5947bc43ae506dbb9cc6cc22e2fa9a74e7&lt;/pre&gt;
</code></pre><ul><li><code>docker container run</code> startet einen neuen Container mittels unseres Images</li><li><code>--detach</code> startet den Container im Hintergrund</li><li><code>--publish 8080:5000</code> veröffentlicht unseren Container auf Port 5000 des Docker Containers und 8080 des Host-Computers<ul><li><code>--publish host_port:container_port</code> – wenn nun Anfragen auf Port 8080 meines Host-Computers treffen, werden diese direkt an Port 5000 des Containers weitergegeben</li></ul></li><li><code>--name</code> vergibt einen Namen an unseren Container</li><li>Zuletzt noch den Namen unseres Images</li></ul><p>Schon ist unser Container gestartet. Mit <code>docker container ls</code>, können wir die aktuell laufenden Container sehen</p><pre><code class=language-terminal data-lang=terminal>[node1] (local) root ~/docker-example-restapi
$ docker container ls
CONTAINER ID        IMAGE                                  COMMAND             CREATED             STATUS              PORTS                    NAMES
7679e475e151        xcalizorz/docker-example-restapi:1.0   &quot;python3 app.py&quot;    18 minutes ago      Up 18 minutes       0.0.0.0:8080-&gt;5000/tcp   responder&lt;/pre&gt;
</code></pre><p>Damit haben wir einen Container, der über <code>Port 8080</code> unseres Host-Computers erreichbar ist.</p><div style=text-align:center><figure class="aligncenter size-large"><img src=/img/docker-2/in_docker_1.webp alt><figcaption>Abbildung 2: GET Anfrage an Docker</figcaption></figure></div><div style=text-align:center><figure class="aligncenter size-large"><img src=/img/docker-2/Sequenzdiagramm.webp alt><figcaption>Abbildung 3: Vereinfachtes Sequenzdiagramm unserer Anwendung</figcaption></figure></div><p>Später wird die Anwendung erweitert und wir tauchen tiefer in die Materie der Container-Welt ein.</p><hr width=100% id=EOF><p style=color:#777>Zuletzt bearbeitet am 25.03.2020</p></div></div><nav class=post-pagination><a class=newer-posts href=https://zrezai-dev.de/container/docker-teil-3/>Nächste<br>Docker – Teil 3: Eintauchen in komplexere Bereiche</a>
<a class=older-posts href=https://zrezai-dev.de/container/docker-teil-1-eine-einfuehrung/>Vorherige<br>Docker – Teil 1: Eine Einführung.</a></nav><div class=post-comment-wrapper></div></div></div></div></div><div id=single-column-footer>Hugo Theme <a href=https://github.com/amazingrise/hugo-theme-diary>Diary</a> von <a href=https://amazingrise.net>Rise</a> ❤️<br>Adaptiert von <a href=https://mak1t0.cc/ target=_blank rel="noreferrer noopener">Makito</a>'s <a href=https://github.com/SumiMakito/hexo-theme-journal/ target=_blank rel="noreferrer noopener">Journal.</a><br><br><div style=font-size:20px><a style=margin:2px href=https://github.com/Xcalizorz target=_blank rel="noreferrer noopener" class="fa fa-github"></a><a style=margin:2px href=https://www.linkedin.com/in/zadjad-rezai/ target=_blank rel="noreferrer noopener" class="fa fa-linkedin"></a><a style=margin:2px href=https://www.xing.com/profile/Zadjad_Rezai/ target=_blank rel="noreferrer noopener" class="fa fa-xing"></a></div>&copy;
2022 Zadjad Rezai.
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css></div></div><script src=js/cookieconsent.min.js></script><script>window.cookieconsent.initialise({"palette":{"popup":{"background":"#237afc"},"button":{"background":"transparent","text":"#fff","border":"#fff"}},"content":{"message":"Diese Website verwendet Cookies, um Ihnen eine bestmögliche Nutzung zu gewährleisten.","dismiss":"Verstanden","link":"Weitere Informationen","href":"https://zrezai-dev.de/datenschutz/"}});</script><script src=/js/journal.js></script></body></html>